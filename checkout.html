<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout â€” Wolly Lully</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { background: var(--bg-white); }
    .checkout-wrap { min-height: 100vh; }
  </style>
</head>
<body>

<!-- ===== CHECKOUT HEADER (minimal) ===== -->
<header class="checkout-header">
  <a href="homepage.html" class="logo">WOLLY LULLY</a>
  <span class="secure-label">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
    Secure Checkout
  </span>
  <a href="shop.html" style="font-size:0.78rem; color:var(--text-muted); text-decoration:underline; white-space:nowrap;">â† Back to shop</a>
</header>

<!-- Mobile: collapsible order summary -->
<button class="order-summary-toggle" id="order-summary-toggle">
  <span>
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" style="margin-right:6px"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/></svg>
    Order summary Â· 2 items
  </span>
  <span style="display:flex; align-items:center; gap:6px;">
    <span id="co-total-mobile" style="font-weight:500;">CHF 479</span>
    <span class="toggle-arrow">â–¼</span>
  </span>
</button>

<!-- CHECKOUT LAYOUT -->
<div class="checkout-layout checkout-wrap">

  <!-- ===== LEFT: FORM ===== -->
  <div class="checkout-form-col">

    <!-- R10: Express checkout options at top -->
    <div class="express-checkout">
      <p>Express checkout</p>
      <div class="express-btns">
        <button class="express-btn apple" onclick="showToast('Apple Pay â€” not implemented in prototype')">
          ğŸ Apple Pay
        </button>
        <button class="express-btn google" onclick="showToast('Google Pay â€” not implemented in prototype')">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="#4285F4"><circle cx="12" cy="12" r="12"/></svg>
          Google Pay
        </button>
      </div>
    </div>

    <div class="divider">or fill in your details below</div>

    <!-- SECTION 1: Contact -->
    <div class="checkout-section">
      <div class="checkout-section-header">
        <div class="checkout-section-num" id="step-num-1">1</div>
        <h3>Contact</h3>
      </div>
      <div class="form-group">
        <label for="email">Email address</label>
        <input type="email" id="email" class="form-input filled" value="anna@example.ch" autocomplete="email">
      </div>
      <label style="display:flex; align-items:center; gap:8px; font-size:0.82rem; color:var(--text-muted); cursor:pointer;">
        <input type="checkbox" checked style="accent-color:var(--gold)">
        Send me occasional news and collection updates
      </label>
    </div>

    <!-- SECTION 2: Delivery -->
    <div class="checkout-section">
      <div class="checkout-section-header">
        <div class="checkout-section-num" id="step-num-2">2</div>
        <h3>Delivery</h3>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="first-name">First name</label>
          <input type="text" id="first-name" class="form-input filled" value="Anna" autocomplete="given-name">
        </div>
        <div class="form-group">
          <label for="last-name">Last name</label>
          <input type="text" id="last-name" class="form-input filled" value="MÃ¼ller" autocomplete="family-name">
        </div>
      </div>
      <div class="form-group">
        <label for="address">Street address</label>
        <input type="text" id="address" class="form-input" placeholder="Bahnhofstrasse 42" autocomplete="street-address">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="postcode">Postcode</label>
          <input type="text" id="postcode" class="form-input" placeholder="8001" autocomplete="postal-code" maxlength="4">
        </div>
        <div class="form-group">
          <label for="city">City</label>
          <input type="text" id="city" class="form-input" placeholder="ZÃ¼rich" autocomplete="address-level2">
        </div>
      </div>
      <div class="form-group">
        <label for="country">Country</label>
        <select id="country" class="form-input" style="cursor:pointer;">
          <option value="CH" selected>Switzerland ğŸ‡¨ğŸ‡­</option>
          <option value="DE">Germany ğŸ‡©ğŸ‡ª</option>
          <option value="AT">Austria ğŸ‡¦ğŸ‡¹</option>
          <option value="FR">France ğŸ‡«ğŸ‡·</option>
        </select>
      </div>

      <!-- Shipping method -->
      <div style="margin-top:16px; padding:16px; background:var(--bg-beige); border-radius:var(--radius); border:1px solid var(--border); display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div style="font-size:0.88rem; font-weight:500; display:flex; align-items:center; gap:8px;">
            <span>âœ…</span> Swiss Post Priority
          </div>
          <div style="font-size:0.78rem; color:var(--text-muted); margin-top:4px;">2â€“3 business days</div>
        </div>
        <div id="shipping-price-display" style="font-size:0.88rem; font-weight:500;">CHF 9</div>
      </div>
      <p style="font-size:0.75rem; color:var(--success); margin-top:8px; display:none;" id="free-shipping-msg">
        ğŸ‰ Free shipping applied on orders over CHF 300!
      </p>
    </div>

    <!-- SECTION 3: Payment -->
    <div class="checkout-section">
      <div class="checkout-section-header">
        <div class="checkout-section-num" id="step-num-3">3</div>
        <h3>Payment</h3>
      </div>

      <div class="payment-options">

        <!-- Credit/Debit Card (selected) -->
        <div class="payment-option selected">
          <div class="payment-option-header">
            <input type="radio" name="payment" value="card" checked>
            <span class="payment-option-label">Credit / Debit Card</span>
            <div class="payment-option-icons">
              <span class="pay-icon">VISA</span>
              <span class="pay-icon">MC</span>
              <span class="pay-icon">AMEX</span>
            </div>
          </div>
          <div class="payment-option-body">
            <div class="form-group" style="margin-bottom:0">
              <label for="card-number">Card number</label>
              <input type="text" id="card-number" class="form-input" placeholder="1234 5678 9012 3456" maxlength="19" autocomplete="cc-number">
            </div>
            <div class="form-row" style="margin-top:12px">
              <div class="form-group" style="margin-bottom:0">
                <label for="card-expiry">Expiry date</label>
                <input type="text" id="card-expiry" class="form-input" placeholder="MM / YY" maxlength="7" autocomplete="cc-exp">
              </div>
              <div class="form-group" style="margin-bottom:0">
                <label for="card-cvv">Security code</label>
                <input type="text" id="card-cvv" class="form-input" placeholder="CVV" maxlength="4" autocomplete="cc-csc">
              </div>
            </div>
            <div style="margin-top:12px">
              <label style="display:flex; align-items:center; gap:8px; font-size:0.82rem; color:var(--text-muted); cursor:pointer;">
                <input type="checkbox" style="accent-color:var(--gold)">
                Save card for future purchases
              </label>
            </div>
          </div>
        </div>

        <!-- Apple Pay -->
        <div class="payment-option">
          <div class="payment-option-header">
            <input type="radio" name="payment" value="apple">
            <span class="payment-option-label">ğŸ Apple Pay</span>
          </div>
        </div>

        <!-- Google Pay -->
        <div class="payment-option">
          <div class="payment-option-header">
            <input type="radio" name="payment" value="google">
            <span class="payment-option-label">Google Pay</span>
          </div>
        </div>

        <!-- TWINT (coming soon) -->
        <div class="payment-option payment-disabled">
          <div class="payment-option-header">
            <input type="radio" name="payment" value="twint" disabled>
            <span class="payment-option-label">TWINT</span>
            <span class="coming-soon">Coming at MVP</span>
          </div>
        </div>

        <!-- PostFinance (coming soon) -->
        <div class="payment-option payment-disabled">
          <div class="payment-option-header">
            <input type="radio" name="payment" value="postfinance" disabled>
            <span class="payment-option-label">PostFinance</span>
            <span class="coming-soon">Coming at MVP</span>
          </div>
        </div>

      </div><!-- /payment-options -->

      <!-- Pay button -->
      <div class="pay-btn-wrapper">
        <button class="btn btn-primary btn--full btn--lg" id="pay-btn" onclick="handlePayment()">
          PAY SECURELY â€” CHF 479
        </button>
      </div>

      <!-- R3: Reassurance below pay button -->
      <p class="checkout-reassurance">
        â†©ï¸ 30-day free returns &nbsp;Â·&nbsp; ğŸ”’ Your payment is encrypted and secure<br>
        By placing your order you agree to our <a href="#" style="text-decoration:underline; color:inherit;">Terms &amp; Conditions</a>.
      </p>

    </div><!-- /payment section -->

  </div><!-- /checkout-form-col -->

  <!-- ===== RIGHT: Order Summary ===== -->
  <div class="order-summary-col" id="order-summary-col">
    <h4 style="font-family:var(--font-sans); font-size:0.7rem; letter-spacing:0.12em; text-transform:uppercase; color:var(--text-muted); margin-bottom:20px; font-weight:500;">
      Order Summary
    </h4>

    <!-- Items (rendered from cart or demo data) -->
    <div class="order-summary-items" id="order-items">
      <!-- Filled by JS -->
    </div>

    <!-- Coupon code -->
    <div class="coupon-row">
      <input type="text" placeholder="Coupon code">
      <button onclick="showToast('No coupon codes available in prototype')">Apply</button>
    </div>

    <!-- Totals -->
    <div class="order-totals">
      <div class="row"><span>Subtotal</span><span id="co-subtotal">CHF 470</span></div>
      <div class="row"><span>Delivery</span><span id="co-shipping">CHF 9</span></div>
      <div class="row" style="font-size:0.78rem; color:var(--text-light)"><span>VAT (7.7%, incl.)</span><span id="co-vat">CHF 34.13</span></div>
      <div class="row total"><span>Total</span><span id="co-total">CHF 479</span></div>
    </div>

    <div class="order-footer">
      ğŸšš Estimated delivery 2â€“3 business days after dispatch<br>
      â†©ï¸ 30-day free returns on all orders
    </div>
  </div>

</div><!-- /checkout-layout -->

<!-- ===== ORDER CONFIRMATION (hidden, shown on pay) ===== -->
<div id="confirmation-screen" style="display:none; position:fixed; inset:0; background:var(--bg-white); z-index:1000; display:none; align-items:center; justify-content:center; padding:24px;">
  <div style="max-width:480px; width:100%; text-align:center;">
    <div style="font-size:3rem; margin-bottom:20px;">âœ…</div>
    <h1 style="font-family:var(--font-serif); font-size:1.8rem; margin-bottom:12px;">Order confirmed!</h1>
    <p style="color:var(--text-muted); margin-bottom:8px;">Thank you, <strong>Anna</strong>. Your order has been received.</p>
    <p style="color:var(--text-muted); margin-bottom:32px; font-size:0.88rem;">
      A confirmation will be sent to <strong>anna@example.ch</strong>.<br>
      Swiss Post Priority Â· Estimated delivery <strong>Feb 26â€“28, 2026</strong>.
    </p>
    <div style="background:var(--bg-beige); border-radius:4px; padding:24px; margin-bottom:28px; text-align:left;">
      <div style="font-size:0.7rem; letter-spacing:0.1em; text-transform:uppercase; color:var(--text-muted); margin-bottom:12px;">Order #WL-2026-0042</div>
      <div id="confirmation-items"></div>
      <div style="border-top:1px solid var(--border); padding-top:12px; margin-top:12px; display:flex; justify-content:space-between; font-weight:500;">
        <span>Total</span><span id="confirmation-total">CHF 479</span>
      </div>
    </div>
    <a href="homepage.html" class="btn btn-primary" style="display:inline-block;">Continue Shopping</a>
  </div>
</div>

<script src="app.js"></script>
<script>
  function handlePayment() {
    const cardNum = document.getElementById('card-number')?.value;
    const address = document.getElementById('address')?.value;

    if (!address) {
      showToast('Please enter your delivery address');
      document.getElementById('address')?.focus();
      return;
    }

    // Simulate payment processing
    const btn = document.getElementById('pay-btn');
    btn.textContent = 'Processingâ€¦';
    btn.disabled = true;
    btn.style.opacity = '0.7';

    setTimeout(() => {
      // Show confirmation
      const screen = document.getElementById('confirmation-screen');
      screen.style.display = 'flex';

      // Populate confirmation items
      const cart = getCart();
      const confirmItems = document.getElementById('confirmation-items');
      const confirmTotal = document.getElementById('confirmation-total');

      if (cart.length > 0) {
        confirmItems.innerHTML = cart.map(item => `
          <div style="display:flex; justify-content:space-between; font-size:0.85rem; padding:4px 0;">
            <span>${item.name} Â· ${item.size} Ã— ${item.qty}</span>
            <span>CHF ${(item.price * item.qty).toFixed(0)}</span>
          </div>
        `).join('');
        const total = cartTotal() + (cartTotal() >= 300 ? 0 : 9);
        confirmTotal.textContent = `CHF ${total.toFixed(0)}`;
        // Clear cart after order
        saveCart([]);
        updateCartBadge();
      } else {
        // Demo items
        confirmItems.innerHTML = `
          <div style="display:flex; justify-content:space-between; font-size:0.85rem; padding:4px 0;">
            <span>Navy Cashmere Crewneck Â· M Ã— 1</span><span>CHF 285</span>
          </div>
          <div style="display:flex; justify-content:space-between; font-size:0.85rem; padding:4px 0;">
            <span>Grey Cashmere Beanie Â· One Size Ã— 1</span><span>CHF 185</span>
          </div>
        `;
      }
    }, 1400);
  }

  // Auto-update shipping display based on total
  document.addEventListener('DOMContentLoaded', () => {
    const total = cartTotal();
    if (total >= 300) {
      document.getElementById('shipping-price-display').textContent = 'Free';
      document.getElementById('free-shipping-msg').style.display = 'block';
      document.getElementById('co-shipping').textContent = 'Free';
    }
  });
</script>
</body>
</html>
